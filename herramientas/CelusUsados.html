<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Celulares Usados</title>
        <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet" />
        <link rel="stylesheet" href="../css/global.css" />
        <link rel="stylesheet" href="../css/CelusUsados.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>

    <body>
        <div class="top-bar">
            <button id="menu-btn" class="menu-button">
                <i class="ri-menu-line"></i>
            </button>
            <h1>Celulares Usados</h1>
            <button id="theme-btn" class="theme-button">
                <i class="ri-sun-line"></i>
            </button>
        </div>

        <div class="sidebar">
            <button class="close-btn">
                <i class="ri-close-line"></i>
            </button>
            <div class="sidebar-links">
                <a href="../index.html">
                    <i class="ri-home-line"></i>
                    <span>Inicio</span>
                </a>
                <a href="StockReparar.html">
                    <i class="ri-tools-line"></i>
                    <span>Stock Reparar</span>
                </a>
                <a href="ReservaRepuestos.html">
                    <i class="ri-calendar-line"></i>
                    <span>Reserva Repuestos</span>
                </a>
                <a href="OrganizadorInsumos.html">
                    <i class="ri-archive-line"></i>
                    <span>Organizador Insumos</span>
                </a>
                <a href="CotizacionUsados.html">
                    <i class="ri-money-dollar-circle-line"></i>
                    <span>Cotización Usados</span>
                </a>
            </div>
        </div>

        <div class="main-content">
            <div class="dashboard-header">
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <i class="ri-smartphone-line"></i>
                        <div class="stat-info">
                            <span class="stat-value" id="total-registros">0</span>
                            <span class="stat-label">Total Registros</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="ri-battery-2-charge-line"></i>
                        <div class="stat-info">
                            <span class="stat-value" id="bateria-optima">0</span>
                            <span class="stat-label">Batería Óptima</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="ri-shopping-bag-line"></i>
                        <div class="stat-info">
                            <span class="stat-value" id="listos-venta">0</span>
                            <span class="stat-label">Listos para Venta</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="ri-line-chart-line"></i>
                        <div class="stat-info">
                            <span class="stat-value" id="tendencia">0%</span>
                            <span class="stat-label">Tendencia Mensual</span>
                        </div>
                    </div>
                </div>
                <button onclick="MostrarEstadisticas()" class="button stats-button">
                    <i class="ri-bar-chart-line"></i>
                    Estadísticas Detalladas
                </button>
            </div>

            <div class="formulario-container">
                <h2>
                    <i class="ri-smartphone-line"></i>
                    Registrar Celular
                </h2>
                <form id="formulario-registro" onsubmit="event.preventDefault(); ProcesarDatos();">
                    <div class="form-group">
                        <select id="Modelo" name="Modelo" required class="form-input">
                            <option value="">Seleccionar Modelo</option>
                            <option value="iPhone 14 Pro">iPhone 14 Pro</option>
                            <option value="iPhone 14">iPhone 14</option>
                            <option value="iPhone 13 Pro">iPhone 13 Pro</option>
                            <option value="iPhone 13">iPhone 13</option>
                            <option value="iPhone 12 Pro">iPhone 12 Pro</option>
                            <option value="iPhone 12">iPhone 12</option>
                            <option value="iPhone 11 Pro">iPhone 11 Pro</option>
                            <option value="iPhone 11">iPhone 11</option>
                            <option value="iPhone XS">iPhone XS</option>
                            <option value="iPhone XR">iPhone XR</option>
                            <option value="iPhone X">iPhone X</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <select id="Variante" name="Variante" required class="form-input">
                            <option value="">Seleccionar Variante</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <select id="Storage" name="Storage" required class="form-input">
                            <option value="">Seleccionar Almacenamiento</option>
                            <option value="64">64 GB</option>
                            <option value="128">128 GB</option>
                            <option value="256">256 GB</option>
                            <option value="512">512 GB</option>
                            <option value="1024">1 TB</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <input type="text" id="IMEI" name="IMEI" placeholder="IMEI" required class="form-input" pattern="\d{15}" title="El IMEI debe tener 15 dígitos">
                    </div>

                    <div class="form-group">
                        <input type="number" id="Bateria3u" name="Bateria3u" placeholder="Batería 3uTools (%)" required class="form-input" min="0" max="100">
                    </div>

                    <div class="form-group">
                        <input type="number" id="BateriaDevice" name="BateriaDevice" placeholder="Batería Device (%)" required class="form-input" min="0" max="100">
                    </div>

                    <div class="form-group">
                        <select id="Limpieza" name="Limpieza" required class="form-input">
                            <option value="">Estado de Limpieza</option>
                            <option value="Completa">Completa</option>
                            <option value="Parcial">Parcial</option>
                            <option value="Pendiente">Pendiente</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <select id="DirectoVenta" name="DirectoVenta" required class="form-input">
                            <option value="">¿Directo a Venta?</option>
                            <option value="Si">Sí</option>
                            <option value="No">No</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <input type="text" id="Proveedor" name="Proveedor" placeholder="Proveedor" required class="form-input">
                    </div>

                    <div class="form-group">
                        <textarea id="Detalles" name="Detalles" placeholder="Detalles adicionales" class="form-input"></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="button">
                            <i class="ri-save-line"></i>
                            Guardar
                        </button>
                        <button type="reset" class="button button-secondary">
                            <i class="ri-refresh-line"></i>
                            Limpiar
                        </button>
                    </div>
                </form>
            </div>

            <div class="registros-container">
                <div class="registros-header">
                    <h2>
                        <i class="ri-list-check-line"></i>
                        Registros
                    </h2>
                    <div class="registros-actions">
                        <div class="filtros">
                            <input type="text" id="busqueda" placeholder="Buscar por IMEI o modelo..." class="form-input">
                            <select id="filtro-modelo" class="form-input">
                                <option value="">Todos los modelos</option>
                                <option value="iPhone 14 Pro">iPhone 14 Pro</option>
                                <option value="iPhone 14">iPhone 14</option>
                                <option value="iPhone 13 Pro">iPhone 13 Pro</option>
                                <option value="iPhone 13">iPhone 13</option>
                                <option value="iPhone 12 Pro">iPhone 12 Pro</option>
                                <option value="iPhone 12">iPhone 12</option>
                                <option value="iPhone 11 Pro">iPhone 11 Pro</option>
                                <option value="iPhone 11">iPhone 11</option>
                                <option value="iPhone XS">iPhone XS</option>
                                <option value="iPhone XR">iPhone XR</option>
                                <option value="iPhone X">iPhone X</option>
                            </select>
                            <select id="filtro-estado" class="form-input">
                                <option value="">Todos los estados</option>
                                <option value="optima">Batería Óptima</option>
                                <option value="venta">Directo a Venta</option>
                            </select>
                            <select id="orden" class="form-input">
                                <option value="fecha-desc">Más recientes primero</option>
                                <option value="fecha-asc">Más antiguos primero</option>
                                <option value="bateria-desc">Mayor batería primero</option>
                                <option value="bateria-asc">Menor batería primero</option>
                                <option value="modelo">Por modelo</option>
                            </select>
                        </div>
                        <div class="acciones">
                            <div class="vista-botones">
                                <button class="button vista-btn active" data-vista="grid">
                                    <i class="ri-grid-fill"></i>
                                </button>
                                <button class="button vista-btn" data-vista="lista">
                                    <i class="ri-list-check"></i>
                                </button>
                            </div>
                            <button onclick="ExportarExcel()" class="button">
                                <i class="ri-file-excel-line"></i>
                                Excel
                            </button>
                            <button onclick="ExportarStickers()" class="button">
                                <i class="ri-printer-line"></i>
                                Stickers
                            </button>
                        </div>
                    </div>
                </div>
                <div id="lista-registros" class="vista-grid"></div>
            </div>
        </div>

        <!-- Modal de Estadísticas -->
        <div id="modal-estadisticas" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Estadísticas Detalladas</h2>
                    <button onclick="CerrarModal('modal-estadisticas')" class="button-icon">
                        <i class="ri-close-line"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="stats-grid">
                        <div class="stat-detail-card">
                            <h3>Distribución por Modelo</h3>
                            <canvas id="graficoModelos"></canvas>
                        </div>
                        <div class="stat-detail-card">
                            <h3>Tendencia de Registros</h3>
                            <canvas id="graficoTendencia"></canvas>
                        </div>
                        <div class="stat-detail-card">
                            <h3>Promedios de Batería</h3>
                            <div id="promedios-bateria"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="toast-container" class="toast-container"></div>
        <script src="../js/global.js"></script>
        <script src="../js/CelusUsados.js"></script>
    </body>
</html>
